from sqlalchemy import create_engine, text
import os

def connect_to_oracle(username, password, hostname, port, service_name, jar_path):
    os.environ['CLASSPATH'] = jar_path
    
    dsn_str = f"oracle+ojdbc6://{username}:{password}@{hostname}:{port}/{service_name}"
    engine = create_engine(dsn_str)
    
    return engine

def execute_query(engine, query):
    with engine.connect() as connection:
        result = connection.execute(text(query))
        rows = result.fetchall()
    
    return rows

if __name__ == '__main__':
    username = 'YOUR_USERNAME'
    password = 'YOUR_PASSWORD'
    hostname = 'YOUR_HOSTNAME'
    port = 'YOUR_PORT'
    service_name = 'YOUR_SERVICE_NAME'
    jar_path = '/path/to/ojdbc11.jar'
    
    engine = connect_to_oracle(username, password, hostname, port, service_name, jar_path)
    
    try:
        query = 'SELECT * FROM YOUR_TABLE_NAME'
        rows = execute_query(engine, query)
        for row in rows:
            print(row)
    finally:
        engine.dispose()
